
#propArticle
  .profile
    = image_tag @idea.user.buddy_icon(:icon_80)
    %b
      = @idea.user.first_name
      %br>/
      = @idea.user.last_name
    = @idea.published_at.strftime("%d.%m.%Y")

  .rightSide
    .head
      %h1= @idea.name
      %p= raw @idea.description
    .votes
      .left
        = image_tag image_path('thumb-yes.png')
        %span.count= @total_up_points
        - if @endorsement and @endorsement.status == 'active'
          - if @endorsement.is_up?
            - # ENDORSED STATE
            %span.endorse_button
              .idea_add{:id => "idea_add_oppose_#{@idea.id.to_s}"}
                = link_to endorsement_path(@endorsement, :region => "idea_inline", :force_debate_to_new=> true),     |
                  :method => :delete,                                                                |
                  :remote=>true,                                                                     |
                  'data-disabled-with' => "idea_debate_spinner_endorse_#{@idea.id.to_s}",                                                         |
                  'data-loader-name' => "external_spinner",                                                     |
                  :class => "idea_add_link button",                                                  |
                  :title => tr("Remove from my list of ideas", "view/ideas") do
                  = tr("ENDORSED", "view/ideas")  
                  .idea_debate_spinner{:id => "idea_debate_spinner_endorse_#{@idea.id.to_s}"} X
          - else
            - # OPPOSED STATE
            %span.idea_add{:id => "idea_add_endorse_#{@idea.id.to_s}"}
              = link_to endorse_idea_path(@idea, :referral_id => (@user || nil), :region => "idea_inline", :value => 1, :force_debate_to_new=> true), |
                :method => :post,                                                                                                                                        |
                :remote => true,                                                                                                                                         |
                'data-disabled-with' => "idea_debate_spinner_endorse_#{@idea.id.to_s}",                                                         |
                'data-loader-name' => "external_spinner",                    |
                :class => "button", |
                :title =>  tr("I support this, add it to my idea list", "view/ideas") do
                = tr("ENDORSE", "view/ideas")
                .idea_debate_spinner{:id => "idea_debate_spinner_endorse_#{@idea.id.to_s}"}
        - else
          - # NOT VOTED STATE
          %span.idea_add{:id => "idea_add_endorse_#{@idea.id.to_s}"}
            = link_to endorse_idea_path(@idea, :referral_id => (@user || nil), :region => "idea_inline", :value => 1, :force_debate_to_new=> true), |
              :method => :post,           |
              :remote => true, |
              'data-disabled-with' => "idea_debate_spinner_endorse_#{@idea.id.to_s}",  |
              'data-loader-name' => "external_spinner",  |
              :class => "idea_add_link button",
              :title =>  tr("I support this, add it to my idea list", "view/ideas") do
              = tr("ENDORSE", "view/ideas")
              .idea_debate_spinner{:id => "idea_debate_spinner_endorse_#{@idea.id.to_s}"}
      .right
        = image_tag image_path('thumb-no.png')
        %span.count= @total_down_points
        - if @endorsement and @endorsement.status == 'active'
          - if @endorsement.is_up?
            - # ENDORSED STATE
            %span.idea_add{:id => "idea_add_oppose_#{@idea.id.to_s}"}
              = link_to endorse_idea_path(@idea, :referral_id => (@user || nil), :region => "idea_inline", :value => -1, :force_debate_to_new=>true), |
                :method => :post,                                                                                                                                        |
                :remote => true,                                                                                                                                         |
                'data-disabled-with' => "idea_debate_spinner_oppose_#{@idea.id.to_s}",                                                         |
                'data-loader-name' => "external_spinner",                      |
                :class => "idea_add_link button button", |
                :title => tr("I oppose this, and want to add my opposition to my idea list.", "view/ideas") do
                = tr("OPPOSE", "view/ideas")
                .idea_debate_spinner{:id => "idea_debate_spinner_oppose_#{@idea.id.to_s}"}
          - else
            - # OPPOSED STATE
            %span.idea_add{:id => "idea_add_oppose_#{@idea.id.to_s}"}
              = link_to endorsement_path(@endorsement, :region => "idea_inline", :force_debate_to_new=> true),     |
                :method => :delete,                                                                |
                :remote=>true,                                                                     |
                'data-disabled-with' => "idea_debate_spinner_oppose_#{@idea.id.to_s}",                                                         |
                'data-loader-name' => "external_spinner",                                                   |
                :class => "idea_add_link button",                                                  |
                :title => tr("Remove from my list of ideas", "view/ideas") do
                = tr("OPPOSED", "view/ideas")
                .idea_debate_spinner{:id => "idea_debate_spinner_oppose_#{@idea.id.to_s}"} X
        - else
          - # NOT VOTED STATE
          %span.idea_add{:id => "idea_add_oppose_#{@idea.id.to_s}"}
            = link_to endorse_idea_path(@idea, :referral_id => (@user || nil), :region => "idea_inline", :value => -1, :force_debate_to_new=> true), |
              :method => :post,   |
              :remote => true,    |
              'data-disabled-with' => "idea_debate_spinner_oppose_#{@idea.id.to_s}", |
              'data-loader-name' => "external_spinner",  |
              :class => "idea_add_link button",
              :title =>  tr("I oppose this, and want to add my opposition to my idea list.", "view/ideas") do
              = tr("OPPOSE", "view/ideas")
              .idea_debate_spinner{:id => "idea_debate_spinner_oppose_#{@idea.id.to_s}"}
    .col-left
      = render :partial => "points/short_list", :locals => {:newest_points=>true, :id => "pro_new", :points => @points_top_up, :numbering=>false}
    .col-right
      = render :partial => "points/short_list", :locals => {:points => @points_top_down, :numbering=>false}

/ .col-group
/   .col-1
/     .col-content
/       %div.sib_left_debate
/         = render :partial => "ideas/nav", :locals => {:idea => @idea, :endorsement => @endorsement, :noaction=> defined?(noaction) ? true : false }
/   .col-11
/     .col-content
/       .col-full
/         .col-content
/           = render :partial => "ideas/idea_status_changelogs"
/       .col-half
/         .col-content.point_for
/           %div
/             .header_add
/               = render partial: "points_header", locals: { idea: @idea, support: true }
/             %div.sub_header
/               = tr("Points for", "view/ideas/top_points")
/               = get_points_number_text(@points_top_up.length,@total_up_points)
/               %span.separator |
/               = #link_to(tr("All points for endorse", "view/ideas/top_points"), endorsed_top_points_idea_url(@idea))
/             #pro_top
/               = render :partial => "points/short_list", :locals => {:id => "pro_top", :points => @points_top_up, :numbering=>true}
/           - unless @points_new_up.empty?
/             .sub_header
/               = tr("Newest Points For", "view/ideas/top_points")
/               = get_points_number_text(@points_new_up.length,@total_up_points_new,true)
/               %span.separator |
/               = link_to(tr("All points for endorse", "view/ideas/top_points"), endorsed_top_points_idea_url(@idea,:by_newest=>true))
/             #pro_new
/               = render :partial => "points/short_list", :locals => {:newest_points=>true, :id => "pro_new", :points => @points_new_up, :numbering=>false}
/       .col-half
/         .col-content.point_against
/           %div
/             .header-add
/               = render partial: "points_header", locals: { idea: @idea, support: false }
/             .sub_header.pro
/               = tr("Points Against", "view/ideas/top_points")
/               = get_points_number_text(@points_top_down.length,@total_down_points)
/               %span.separator |
/               = #link_to(tr("All points for oppose", "view/ideas/top_points"), opposed_top_points_idea_url(@idea))
/             #con_top
/               = render :partial => "points/short_list", :locals => {:id => "con_top", :points => @points_top_down, :numbering=>true}
/             - unless @points_new_down.empty?
/               .sub_header
/                 = tr("Newest Points Against", "view/ideas/top_points")
/                 = get_points_number_text(@points_new_down.length,@total_down_points_new,true)
/                 %span.separator |
/                 = link_to(tr("All points for oppose", "view/ideas/top_points"), opposed_top_points_idea_url(@idea,:by_newest=>true))
/               #con_new
/                 = render :partial => "points/short_list", :locals => {:newest_points=>true, :id => "con_new", :points => @points_new_down, :numbering=>false}
/     - if request.xhr?
/       .col-group
/         .col-full
/           .col-content
/             .more_container
/               = link_to tr("More...", "view/ideas/idea_detail"), idea_path(@idea), class: "idea_detail_more"
